"""
–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö Excel-—Ñ–∞–π–ª–æ–≤
"""

from schedule_base import (
    Teacher, Student, Class, Classroom, Subject,
    EGEPracticeGroup, DayOfWeek, SubjectType
)
from typing import Dict, List
import random


def create_demo_classrooms() -> Dict[str, Classroom]:
    """–°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-–∫–∞–±–∏–Ω–µ—Ç–æ–≤ (29 –∫–∞–±–∏–Ω–µ—Ç–æ–≤)"""
    classrooms = {}

    # –ö–∞–±–∏–Ω–µ—Ç—ã —Å —Ä–∞–∑–Ω–æ–π –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é
    room_configs = [
        # (–Ω–æ–º–µ—Ä, –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, —ç—Ç–∞–∂)
        ("101", 30, 1), ("102", 30, 1), ("103", 25, 1), ("104", 20, 1),
        ("105", 35, 1), ("106", 30, 1), ("107", 15, 1),
        ("201", 30, 2), ("202", 30, 2), ("203", 25, 2), ("204", 20, 2),
        ("205", 40, 2), ("206", 30, 2), ("207", 25, 2), ("208", 15, 2),
        ("301", 30, 3), ("302", 30, 3), ("303", 25, 3), ("304", 20, 3),
        ("305", 35, 3), ("306", 30, 3), ("307", 25, 3),
        ("401", 30, 4), ("402", 30, 4), ("403", 25, 4), ("404", 20, 4),
        ("405", 35, 4), ("406", 30, 4),
        ("–ê–∫—Ç–æ–≤—ã–π –∑–∞–ª", 60, 1),  # –ë–æ–ª—å—à–æ–π –∑–∞–ª
    ]

    for number, capacity, floor in room_configs:
        classrooms[number] = Classroom(
            number=number,
            capacity=capacity,
            floor=floor
        )

    return classrooms


def create_demo_teachers() -> Dict[str, Teacher]:
    """–°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-—É—á–∏—Ç–µ–ª–µ–π (43 —É—á–∏—Ç–µ–ª—è)"""
    teachers = {}

    # –£—á–∏—Ç–µ–ª—è —Å –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏
    teacher_data = [
        # (–§–ò–û, –ø—Ä–µ–¥–º–µ—Ç—ã, –¥–æ–º–∞—à–Ω–∏–π –∫–∞–±–∏–Ω–µ—Ç, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–Ω–∏)
        ("–ò–≤–∞–Ω–æ–≤–∞ –ê.–ê.", ["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"], "101", set()),
        ("–ü–µ—Ç—Ä–æ–≤–∞ –ë.–ë.", ["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫"], "102", set()),
        ("–°–∏–¥–æ—Ä–æ–≤–∞ –í.–í.", ["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"], "103", set()),
        ("–ö–æ–∑–ª–æ–≤ –ì.–ì.", ["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–ê–ª–≥–µ–±—Ä–∞", "–ì–µ–æ–º–µ—Ç—Ä–∏—è"], "201", set()),
        ("–ù–æ–≤–∏–∫–æ–≤ –î.–î.", ["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–ê–ª–≥–µ–±—Ä–∞"], "202", set()),
        ("–ú–æ—Ä–æ–∑–æ–≤–∞ –ï.–ï.", ["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "–ì–µ–æ–º–µ—Ç—Ä–∏—è"], "203", set()),
        ("–í–æ–ª–∫–æ–≤ –ñ.–ñ.", ["–§–∏–∑–∏–∫–∞"], "301", set()),
        ("–ó–∞–π—Ü–µ–≤–∞ –ó.–ó.", ["–§–∏–∑–∏–∫–∞"], "302", set()),
        ("–õ–µ–±–µ–¥–µ–≤–∞ –ò.–ò.", ["–•–∏–º–∏—è"], "303", set()),
        ("–û—Ä–ª–æ–≤ –ö.–ö.", ["–ë–∏–æ–ª–æ–≥–∏—è"], "304", set()),
        ("–°–æ–∫–æ–ª–æ–≤–∞ –õ.–õ.", ["–ò—Å—Ç–æ—Ä–∏—è", "–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ"], "305", set()),
        ("–ü–æ–ø–æ–≤ –ú.–ú.", ["–ò—Å—Ç–æ—Ä–∏—è"], "306", set()),
        ("–í–æ—Ä–æ–±—å–µ–≤–∞ –ù.–ù.", ["–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ"], "307", set()),
        ("–§–µ–¥–æ—Ä–æ–≤ –û.–û.", ["–ì–µ–æ–≥—Ä–∞—Ñ–∏—è"], "401", set()),
        ("–ú–∏—Ö–∞–π–ª–æ–≤–∞ –ü.–ü.", ["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫"], "402", set()),
        ("–ù–∏–∫–æ–ª–∞–µ–≤ –†.–†.", ["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫"], "403", set()),
        ("–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∞ –°.–°.", ["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫"], "404", set()),
        ("–ï–≥–æ—Ä–æ–≤–∞ –ù.–í.", ["–ù–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫"], "405", {DayOfWeek.MONDAY}),
        ("–ö—É–∑–Ω–µ—Ü–æ–≤–∞ –¢.–¢.", ["–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π —è–∑—ã–∫"], "406", set()),
        ("–°–º–∏—Ä–Ω–æ–≤ –£.–£.", ["–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞"], "204", set()),
        ("–í–∞—Å–∏–ª—å–µ–≤ –§.–§.", ["–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞"], "205", set()),

        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—á–∏—Ç–µ–ª—è
        ("–ü–∞–≤–ª–æ–≤–∞ –•.–•.", ["–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞"], None, set()),
        ("–°–µ–º–µ–Ω–æ–≤ –¶.–¶.", ["–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞"], None, set()),
        ("–ì–æ–ª—É–±–µ–≤–∞ –ß.–ß.", ["–û–ë–ñ"], "206", set()),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–æ–≤ –®.–®.", ["–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è"], "207", set()),
        ("–ë–æ–≥–¥–∞–Ω–æ–≤–∞ –©.–©.", ["–ú—É–∑—ã–∫–∞"], "208", set()),
        ("–í–æ—Ä–æ–Ω–æ–≤ –≠.–≠.", ["–ò–ó–û"], "105", set()),
        ("–ú–µ–¥–≤–µ–¥–µ–≤ –Æ.–Æ.", ["–≠–∫–æ–Ω–æ–º–∏–∫–∞"], "106", set()),
        ("–¢–∞—Ä–∞—Å–æ–≤ –Ø.–Ø.", ["–ü—Ä–∞–≤–æ"], "107", set()),

        # –£—á–∏—Ç–µ–ª—è, –Ω–µ —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –ø–æ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫–∞–º
        ("–ó–∞–∫—Ä–µ–≤—Å–∫–∞—è –ï.–ê.", ["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫"], None, {DayOfWeek.MONDAY}),
        ("–ó–∞—Ç–æ–ø–ª—è–µ–≤–∞ –û.–í.", ["–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"], None, {DayOfWeek.MONDAY}),
        ("–ö–∞—Ä–µ—Ç–Ω–∏–∫–æ–≤–∞ –ê.–í.", ["–ò—Å—Ç–æ—Ä–∏—è"], None, {DayOfWeek.MONDAY}),
        ("–ù–æ–≤–æ—Ä–∞–¥–æ–≤—Å–∫–∞—è –ü.–ê.", ["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫"], None, {DayOfWeek.MONDAY}),
        ("–°–µ–≤–µ—Ä–∏–Ω –ê.–ê.", ["–§–∏–∑–∏–∫–∞"], None, {DayOfWeek.MONDAY}),
        ("–¢–µ—Ä–µ—Ö–æ–≤ –ú.–†.", ["–•–∏–º–∏—è"], None, {DayOfWeek.MONDAY}),
        ("–¶—É–∫–∞–Ω–æ–≤–∞ –ú.–õ.", ["–ë–∏–æ–ª–æ–≥–∏—è"], None, {DayOfWeek.MONDAY}),
        ("–ß–µ—Ä–Ω–∞—è –ï.–ê.", ["–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ"], None, {DayOfWeek.MONDAY}),
        ("–®–∞—Ö –ú.–í.", ["–ì–µ–æ–≥—Ä–∞—Ñ–∏—è"], None, {DayOfWeek.MONDAY}),
        ("–®–µ—Ö—É—Ä–¥–∏–Ω–∞ –ê.–ê.", ["–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞"], None, {DayOfWeek.MONDAY}),
        ("–ö—É–¥—Ä—è—à–æ–≤–∞ –ê.–ú.", ["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫"], None, {DayOfWeek.MONDAY}),

        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—á–∏—Ç–µ–ª—è –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫—É–º–æ–≤ –ï–ì–≠
        ("–†–æ–º–∞–Ω–æ–≤ –ê.–ë.", ["–ò—Å–ø–∞–Ω—Å–∫–∏–π —è–∑—ã–∫"], None, set()),
        ("–ö–∏—Ç–∞–µ–≤ –í.–ì.", ["–ö–∏—Ç–∞–π—Å–∫–∏–π —è–∑—ã–∫"], None, set()),
        ("–®–Ω–∞–π–¥–µ—Ä –û.–ê.", ["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", "–ü—Ä–∞–∫—Ç–∏–∫—É–º –ï–ì–≠ –ø–æ —Ä—É—Å—Å–∫–æ–º—É —è–∑—ã–∫—É"], "101", set()),
    ]

    for name, subjects, home, unavailable in teacher_data:
        teachers[name] = Teacher(
            name=name,
            subjects=subjects,
            home_classroom=home,
            unavailable_days=unavailable
        )

    return teachers


def create_demo_classes() -> Dict[str, Class]:
    """–°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-–∫–ª–∞—Å—Å–æ–≤ (10 –≤—ã–ø—É—Å–∫–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤)"""
    classes = {}

    class_data = [
        ("11-–ê", "–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π"),
        ("11-–ë", "–ì—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã–π"),
        ("11-–í", "–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–Ω–∞—É—á–Ω—ã–π"),
        ("11-–ì", "–°–æ—Ü–∏–∞–ª—å–Ω–æ-—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π"),
        ("11-–î", "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π"),
        ("11-–ï", "–í–æ—Å—Ç–æ–∫–æ–≤–µ–¥–µ–Ω–∏–µ"),
        ("11-–ñ", "–î–∏–∑–∞–π–Ω"),
        ("11-–ó", "–ú–µ–¥–∏–∞–∫–ª–∞—Å—Å"),
        ("11-–ò", "–ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å–∫–∏–π"),
        ("11-–ö", "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π"),
    ]

    for name, profile in class_data:
        classes[name] = Class(name=name, profile=profile, students=[])

    return classes


def create_demo_students(classes: Dict[str, Class]) -> Dict[str, Student]:
    """–°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-—É—á–µ–Ω–∏–∫–æ–≤ (256 —É—á–µ–Ω–∏–∫–æ–≤)"""
    students = {}

    # –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –ï–ì–≠ (–≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö)
    ege_popularity = {
        "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫": 100,  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –±–∞–∑–æ–≤–∞—è": 70,
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å–Ω–∞—è": 30,
        "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫": 56,
        "–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ": 54,
        "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞": 29,
        "–ò—Å—Ç–æ—Ä–∏—è": 20,
        "–§–∏–∑–∏–∫–∞": 5,
        "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": 5,
        "–ë–∏–æ–ª–æ–≥–∏—è": 4,
        "–•–∏–º–∏—è": 4,
        "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è": 3,
        "–ù–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫": 1,
        "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π —è–∑—ã–∫": 1,
        "–ò—Å–ø–∞–Ω—Å–∫–∏–π —è–∑—ã–∫": 1,
    }

    # –ò–º–µ–Ω–∞ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    first_names = [
        "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", "–ê–ª–µ–∫—Å–µ–π", "–ê–Ω–¥—Ä–µ–π", "–ê—Ä—Ç–µ–º", "–í–ª–∞–¥–∏–º–∏—Ä",
        "–î–º–∏—Ç—Ä–∏–π", "–ï–≥–æ—Ä", "–ò–≤–∞–Ω", "–ö–∏—Ä–∏–ª–ª", "–ú–∞–∫—Å–∏–º",
        "–ú–∏—Ö–∞–∏–ª", "–ù–∏–∫–∏—Ç–∞", "–ü–∞–≤–µ–ª", "–†–æ–º–∞–Ω", "–°–µ—Ä–≥–µ–π",
        "–ê–Ω–Ω–∞", "–î–∞—Ä—å—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "–ï–ª–µ–Ω–∞", "–ú–∞—Ä–∏—è",
        "–ù–∞—Ç–∞–ª—å—è", "–û–ª—å–≥–∞", "–ü–æ–ª–∏–Ω–∞", "–°–æ—Ñ–∏—è", "–Æ–ª–∏—è"
    ]

    last_names = [
        "–ò–≤–∞–Ω–æ–≤", "–ü–µ—Ç—Ä–æ–≤", "–°–∏–¥–æ—Ä–æ–≤", "–ö–æ–∑–ª–æ–≤", "–ù–æ–≤–∏–∫–æ–≤",
        "–ú–æ—Ä–æ–∑–æ–≤", "–í–æ–ª–∫–æ–≤", "–ó–∞–π—Ü–µ–≤", "–õ–µ–±–µ–¥–µ–≤", "–û—Ä–ª–æ–≤",
        "–°–æ–∫–æ–ª–æ–≤", "–ü–æ–ø–æ–≤", "–í–æ—Ä–æ–±—å–µ–≤", "–§–µ–¥–æ—Ä–æ–≤", "–ú–∏—Ö–∞–π–ª–æ–≤",
        "–ù–∏–∫–æ–ª–∞–µ–≤", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤", "–ï–≥–æ—Ä–æ–≤", "–ö—É–∑–Ω–µ—Ü–æ–≤", "–°–º–∏—Ä–Ω–æ–≤"
    ]

    student_id = 0
    class_list = list(classes.keys())

    # –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º ~26 —É—á–µ–Ω–∏–∫–æ–≤ –Ω–∞ –∫–ª–∞—Å—Å
    for class_name in class_list:
        num_students = random.randint(24, 28)

        for _ in range(num_students):
            student_id += 1

            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –§–ò–û
            first = random.choice(first_names)
            last = random.choice(last_names)

            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∂–µ–Ω—Å–∫–∞—è –∏–ª–∏ –º—É–∂—Å–∫–∞—è —Ñ–∞–º–∏–ª–∏—è –Ω—É–∂–Ω–∞
            if first in ["–ê–Ω–Ω–∞", "–î–∞—Ä—å—è", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞", "–ï–ª–µ–Ω–∞", "–ú–∞—Ä–∏—è",
                         "–ù–∞—Ç–∞–ª—å—è", "–û–ª—å–≥–∞", "–ü–æ–ª–∏–Ω–∞", "–°–æ—Ñ–∏—è", "–Æ–ª–∏—è"]:
                if not last.endswith("–∞"):
                    last = last + "–∞"

            name = f"{last} {first}"

            # –í—ã–±–∏—Ä–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã –ï–ì–≠
            ege_subjects = ["–†—É—Å—Å–∫–∏–π —è–∑—ã–∫"]  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π

            # –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞: –±–∞–∑–æ–≤–∞—è –∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å–Ω–∞—è
            if random.random() < 0.3:
                ege_subjects.append("–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å–Ω–∞—è")
            else:
                ege_subjects.append("–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –±–∞–∑–æ–≤–∞—è")

            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (2-3 –Ω–∞ –≤—ã–±–æ—Ä)
            additional_count = random.randint(2, 3)
            other_subjects = [s for s in ege_popularity.keys()
                             if s not in ege_subjects]

            # –í—ã–±–∏—Ä–∞–µ–º —Å —É—á–µ—Ç–æ–º –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
            weights = [ege_popularity[s] for s in other_subjects]
            chosen = random.choices(other_subjects, weights=weights, k=additional_count)
            ege_subjects.extend(chosen)

            student = Student(
                name=name,
                class_name=class_name,
                ege_subjects=list(set(ege_subjects))  # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
            )

            students[name] = student
            classes[class_name].students.append(student)

    return students


def create_demo_subjects(teachers: Dict[str, Teacher], classes: Dict[str, Class]) -> List[Subject]:
    """–°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-–ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è 11 –∫–ª–∞—Å—Å–æ–≤)"""
    subjects = []

    # –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –¥–ª—è 11 –∫–ª–∞—Å—Å–æ–≤
    # (–ø—Ä–µ–¥–º–µ—Ç, —á–∞—Å–æ–≤ –≤ –Ω–µ–¥–µ–ª—é, —É—á–∏—Ç–µ–ª—å)
    subject_config = [
        ("–†—É—Å—Å–∫–∏–π —è–∑—ã–∫", 2, "–ò–≤–∞–Ω–æ–≤–∞ –ê.–ê."),
        ("–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", 3, "–°–∏–¥–æ—Ä–æ–≤–∞ –í.–í."),
        ("–ê–ª–≥–µ–±—Ä–∞", 4, "–ö–æ–∑–ª–æ–≤ –ì.–ì."),
        ("–ì–µ–æ–º–µ—Ç—Ä–∏—è", 2, "–ú–æ—Ä–æ–∑–æ–≤–∞ –ï.–ï."),
        ("–ò—Å—Ç–æ—Ä–∏—è", 2, "–°–æ–∫–æ–ª–æ–≤–∞ –õ.–õ."),
        ("–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ", 2, "–í–æ—Ä–æ–±—å–µ–≤–∞ –ù.–ù."),
        ("–§–∏–∑–∏–∫–∞", 2, "–í–æ–ª–∫–æ–≤ –ñ.–ñ."),
        ("–•–∏–º–∏—è", 1, "–õ–µ–±–µ–¥–µ–≤–∞ –ò.–ò."),
        ("–ë–∏–æ–ª–æ–≥–∏—è", 1, "–û—Ä–ª–æ–≤ –ö.–ö."),
        ("–ì–µ–æ–≥—Ä–∞—Ñ–∏—è", 1, "–§–µ–¥–æ—Ä–æ–≤ –û.–û."),
        ("–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫", 3, "–ú–∏—Ö–∞–π–ª–æ–≤–∞ –ü.–ü."),
        ("–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", 1, "–°–º–∏—Ä–Ω–æ–≤ –£.–£."),
        ("–§–∏–∑–∫—É–ª—å—Ç—É—Ä–∞", 3, "–ü–∞–≤–ª–æ–≤–∞ –•.–•."),
        ("–û–ë–ñ", 1, "–ì–æ–ª—É–±–µ–≤–∞ –ß.–ß."),
    ]

    class_names = list(classes.keys())

    for subject_name, hours, teacher_name in subject_config:
        teacher = teachers.get(teacher_name)
        if not teacher:
            continue

        # –°–æ–∑–¥–∞–µ–º –ø—Ä–µ–¥–º–µ—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
        for class_name in class_names:
            subject = Subject(
                name=subject_name,
                subject_type=SubjectType.MANDATORY,
                hours_per_week=hours,
                teacher=teacher,
                classes=[class_name]
            )
            subjects.append(subject)

    return subjects


def create_demo_ege_groups(students: Dict[str, Student], teachers: Dict[str, Teacher]) -> List[EGEPracticeGroup]:
    """–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫—É–º–æ–≤ –ï–ì–≠"""
    from collections import defaultdict

    # –ì—Ä—É–ø–ø–∏—Ä—É–µ–º —É—á–µ–Ω–∏–∫–æ–≤ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –ï–ì–≠
    subject_students = defaultdict(list)

    for student in students.values():
        for ege_subject in student.ege_subjects:
            subject_students[ege_subject].append(student)

    # –ú–∞–ø–ø–∏–Ω–≥ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –Ω–∞ —É—á–∏—Ç–µ–ª–µ–π
    ege_teachers = {
        "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫": "–®–Ω–∞–π–¥–µ—Ä –û.–ê.",
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –±–∞–∑–æ–≤–∞—è": "–ö–æ–∑–ª–æ–≤ –ì.–ì.",
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å–Ω–∞—è": "–ù–æ–≤–∏–∫–æ–≤ –î.–î.",
        "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫": "–ú–∏—Ö–∞–π–ª–æ–≤–∞ –ü.–ü.",
        "–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ": "–í–æ—Ä–æ–±—å–µ–≤–∞ –ù.–ù.",
        "–ò—Å—Ç–æ—Ä–∏—è": "–ü–æ–ø–æ–≤ –ú.–ú.",
        "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞": "–°–∏–¥–æ—Ä–æ–≤–∞ –í.–í.",
        "–§–∏–∑–∏–∫–∞": "–í–æ–ª–∫–æ–≤ –ñ.–ñ.",
        "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": "–°–º–∏—Ä–Ω–æ–≤ –£.–£.",
        "–ë–∏–æ–ª–æ–≥–∏—è": "–û—Ä–ª–æ–≤ –ö.–ö.",
        "–•–∏–º–∏—è": "–õ–µ–±–µ–¥–µ–≤–∞ –ò.–ò.",
        "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è": "–§–µ–¥–æ—Ä–æ–≤ –û.–û.",
        "–ù–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫": "–ï–≥–æ—Ä–æ–≤–∞ –ù.–í.",
        "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π —è–∑—ã–∫": "–ö—É–∑–Ω–µ—Ü–æ–≤–∞ –¢.–¢.",
        "–ò—Å–ø–∞–Ω—Å–∫–∏–π —è–∑—ã–∫": "–†–æ–º–∞–Ω–æ–≤ –ê.–ë.",
        "–ö–∏—Ç–∞–π—Å–∫–∏–π —è–∑—ã–∫": "–ö–∏—Ç–∞–µ–≤ –í.–ì.",
    }

    # –ß–∞—Å—ã –≤ –Ω–µ–¥–µ–ª—é –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∞–∫—Ç–∏–∫—É–º–∞
    ege_hours = {
        "–†—É—Å—Å–∫–∏–π —è–∑—ã–∫": 3,
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –±–∞–∑–æ–≤–∞—è": 3,
        "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å–Ω–∞—è": 3,
        "–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫": 4,
        "–û–±—â–µ—Å—Ç–≤–æ–∑–Ω–∞–Ω–∏–µ": 4,
        "–ò—Å—Ç–æ—Ä–∏—è": 4,
        "–õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞": 3,
        "–§–∏–∑–∏–∫–∞": 4,
        "–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": 4,
        "–ë–∏–æ–ª–æ–≥–∏—è": 4,
        "–•–∏–º–∏—è": 4,
        "–ì–µ–æ–≥—Ä–∞—Ñ–∏—è": 3,
        "–ù–µ–º–µ—Ü–∫–∏–π —è–∑—ã–∫": 4,
        "–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π —è–∑—ã–∫": 4,
        "–ò—Å–ø–∞–Ω—Å–∫–∏–π —è–∑—ã–∫": 4,
        "–ö–∏—Ç–∞–π—Å–∫–∏–π —è–∑—ã–∫": 4,
    }

    groups = []

    for ege_subject, student_list in subject_students.items():
        if len(student_list) == 0:
            continue

        teacher_name = ege_teachers.get(ege_subject)
        teacher = teachers.get(teacher_name) if teacher_name else None

        if not teacher:
            # –ë–µ—Ä–µ–º –ø–µ—Ä–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ —É—á–∏—Ç–µ–ª—è
            teacher = list(teachers.values())[0]

        hours = ege_hours.get(ege_subject, 3)

        group = EGEPracticeGroup(
            subject=ege_subject,
            teacher=teacher,
            students=student_list,
            hours_per_week=hours
        )
        groups.append(group)

    return groups


class DemoDataLoader:
    """–ó–∞–≥—Ä—É–∑—á–∏–∫ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ DataLoader –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)"""

    def __init__(self):
        self.teachers: Dict[str, Teacher] = {}
        self.classrooms: Dict[str, Classroom] = {}
        self.classes: Dict[str, Class] = {}
        self.students: Dict[str, Student] = {}
        self.subjects: List[Subject] = []
        self.ege_groups: List[EGEPracticeGroup] = []

    def load_all(self):
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ"""
        print("=" * 100)
        print(" " * 30 + "–ó–ê–ì–†–£–ó–ö–ê –î–ï–ú–û-–î–ê–ù–ù–´–•")
        print("=" * 100)

        print("\nüìÇ –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö...")

        self.classrooms = create_demo_classrooms()
        print(f"‚úì –°–æ–∑–¥–∞–Ω–æ {len(self.classrooms)} –∫–∞–±–∏–Ω–µ—Ç–æ–≤")

        self.teachers = create_demo_teachers()
        print(f"‚úì –°–æ–∑–¥–∞–Ω–æ {len(self.teachers)} —É—á–∏—Ç–µ–ª–µ–π")

        self.classes = create_demo_classes()
        print(f"‚úì –°–æ–∑–¥–∞–Ω–æ {len(self.classes)} –∫–ª–∞—Å—Å–æ–≤")

        self.students = create_demo_students(self.classes)
        print(f"‚úì –°–æ–∑–¥–∞–Ω–æ {len(self.students)} —É—á–µ–Ω–∏–∫–æ–≤")

        self.subjects = create_demo_subjects(self.teachers, self.classes)
        print(f"‚úì –°–æ–∑–¥–∞–Ω–æ {len(self.subjects)} –ø—Ä–µ–¥–º–µ—Ç–æ–≤")

        self.ege_groups = create_demo_ege_groups(self.students, self.teachers)
        print(f"‚úì –°–æ–∑–¥–∞–Ω–æ {len(self.ege_groups)} –≥—Ä—É–ø–ø –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫—É–º–æ–≤ –ï–ì–≠")

        self.print_summary()

    def print_summary(self):
        """–í—ã–≤–æ–¥ —Å–≤–æ–¥–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏"""
        print("\n" + "=" * 100)
        print(" " * 35 + "–°–í–û–î–ö–ê –ü–û –î–ê–ù–ù–´–ú")
        print("=" * 100)

        print(f"\nüìö –£—á–∏—Ç–µ–ª–µ–π: {len(self.teachers)}")
        print(f"   - –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ –ü–ù: {sum(1 for t in self.teachers.values() if DayOfWeek.MONDAY in t.unavailable_days)}")

        print(f"üè´ –ö–∞–±–∏–Ω–µ—Ç–æ–≤: {len(self.classrooms)}")
        print(f"   - –º–∞–∫—Å. –≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: {max(c.capacity for c in self.classrooms.values())}")

        print(f"üë• –ö–ª–∞—Å—Å–æ–≤: {len(self.classes)}")
        print(f"üéì –£—á–µ–Ω–∏–∫–æ–≤: {len(self.students)}")

        print(f"üìñ –ü—Ä–µ–¥–º–µ—Ç–æ–≤: {len(self.subjects)}")
        print(f"üéØ –ì—Ä—É–ø–ø –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫—É–º–æ–≤ –ï–ì–≠: {len(self.ege_groups)}")

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º –ï–ì–≠
        from collections import Counter
        ege_counts = Counter()
        for student in self.students.values():
            ege_counts.update(student.ege_subjects)

        print("\nüìä –¢–û–ü-5 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –ï–ì–≠:")
        for i, (subj, count) in enumerate(ege_counts.most_common(5), 1):
            pct = count / len(self.students) * 100
            print(f"  {i}. {subj}: {count} —É—á–µ–Ω–∏–∫–æ–≤ ({pct:.1f}%)")

        print("\n‚úÖ –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
        print("=" * 100)


# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
if __name__ == "__main__":
    loader = DemoDataLoader()
    loader.load_all()
